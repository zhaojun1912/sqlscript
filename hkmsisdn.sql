SELECT ca.custcode, ca.customer_id, coa.co_id CONTRACT_ID,dn.dn_num HKG_MSISDN, cs1.cs_sparam1 CHN_MSISDN,ch.ch_status
FROM customer_all ca,  contr_services cs,  contr_services cs1, directory_number dn,contract_all coa, contract_history ch
WHERE (coa.co_id IN (6178466
,4009545
,5701495
,5794827
,5908427
,5908088
,5881143
,4359012
,4509669
,3972779
,3886598
,6339009
,5789241
,4527717
,4289739
,3769528
,5987659
,6114780
,5817644
,900184
,3236595
,4707126
,3866610
,5102805
,6180130
,4944446
,5905542
,4078681
,4444352
,4007744
,5973678
,5979340
,5864110
,4195890
,5827874
,3855655
,5653751
,2000136
,4287166
,5910268
,6305976
,5391794
,3405924
,3769368
,5957843
,4631070
,5050298
,6168718
,4509678
,5339307
,4078732
,4647544
,6109827
,4136263
,4630413
,5726580
,3400516
,4889086
,4694477
,4354065
,6032054
,4963041
,5657112
,4425165
,5104594
,6010847
,4216755
,4812441
,4523184
,3203683
,2051279
,4708200
,4341235
,6143468
,6382316
,5761822
,5760541
,5255720
,3914226
,3400541
,3400528
,5413294
,4392714
,4404823
,4916842
,4591974
,3400510
,5255731
,4344510
,4992982
,6468807
,5435121
,6016392
,5283483
,6207135
,5616870
,4418546
,4374231
,5878672
,4195881
,4195902
,5952911
,3769557
,6178461
,6178480
,5999144
,5252451
,5814264
,5079961
,4862370
,5048087
,5203376
,4721206
,5958339
,3400501
,3204504
,4104838
,5932483
,5032589
,3998052
,4647524
,5471506
,6109742
,5879850
,5085560
,4481950
,4708198
,5784063
,5786762
,5265562
,4416938
,4256883
,5956096
,5979143
,5524114
,3957960
,4078683
,2046278
,4053711
,4136258
,3205286
,4249685
,5862249
,5248534
,3933702
,43203
,4709368
,5576994
,4024162
,4718829
,5000960
,6411945
,5423978
,5965807
,4930983
,3847598
,6021585
,5979308
,6363361
,6376527
,5620507
,3972773
,4783957
,5567143
,4056819
,5474243
,4437730
,3833779
,5944463
,4930964
,4069376
,4176123
,6200959
,3891790
,4202842
,4179309
,5900864
,6363176
,4062254
,3400568
,6051266
,5326366
,5110765
,5012608
,3205297
,4175188
,5932710
,5255727
,4406348
,5574140
,4812438
,6364627
,4476161
,5057613
,3956080
,6143473
,5849661
,5864424
,4128893
,6203536
,6400348
,6021586
,6371146
,4699310
,4162508
,5695257
,5419832
,6357933
,4425699
,4054564
,6143461
,3400575
,5306944
,5963891
,4303171
,5688257
,5921468
,5042162
,6028857
,6331861
,4326802
,4944455
,4666787
,3574962
,4586116
,5311083
,5817458
,5613945
,3400506
,5859365
,4709371
,5827843
,4887560
,5430134
,5059363
,5913615
,3400517
,5864138
,4057219
,3204475
,5688264
,3863958
,5966146
,4038849
,4595301
,6364622
,5898310
,6001379
,5979934
,4338729
,4596792
,4812426
,4900285
,5255733
,5265524
,4694476
,5615948
,4195825
,4127600
,4811394
,4631072
,5955074
,6268521
,5610284
,6178467
,4694468
,3769544
,6178479
,4622031
,6143469
,4307290
,4123079
,6029320
,3471196
,4848711
,4995284
,3471219
,3923126
,6043523
,4782045
,4195969
,5151439
,5737634
,5932719
,5078649
,5932723
,5682037
,3585863
,344416
,5271964
,6044300
,5078659
,4629810
,4631079
,5176191
,4091076
,5826781
,5827849
,5032523
,4218653
,4707129
,5980358
,4647545
,5684460
,4682179
,6411960
,5417082
,5944839
,4653411
,6411685
,4426250
,3810204
,4411106
,4508305
,5878339
,5078668
,4596808
,6021590
,5194929
,5358048
,3203556
,6382194
,5773059
,5992827
,5272752
,4195915
,6240158
,4245958
,3400542
,5955689
,4596802
,4779185
,4354773
,4708211
,4020508
,5958297
,5110627
,5592304
,6044186
,4389379
,5940746
,6178487
,4090380
,4106374
,4359011
,5653749
,4502566
,5744525
,4195936
,5229284
,6021575
,3894910
,5964396
,3585951
,4956751
,4482600
,5653741
,3690530
,6178478
,4195867
,5881119
,4176124
,3351338
,5247401
,4426265
,5761841
,4154351
,5274739
,3972769
,2002323
,3840476
,4024173
,5048494
,5103917
,3203766
,3916429
,5920523
,4631074
,5957846
,5951885
,5966775
,5203302
,4493710
,4391379
,5712868
,6178583
,6143459
,3400532
,4661410
,193783
,3203503
,4694461
,4664000
,5175136
,4649912
,5739178
,5706024
,5184142
,5305569
,5812711
,4384545
,4410969
,4176156
,5948304
,4504658
,4231331
,4354069
,4489705
,5943117
,4386874
,4596775
,3400556
,6228433
,3174551
,5927683
,5916573
,5105913
,4944457
,3769558
,5340658
,3400514
,6346211
,5247409
,5794604
,5691797
,5059365
,4596766
,5744507
,4595306
,4596770
,4988152
,5255728
,5438593
,3438806
,6178550
,4829331
,5078669
,6380306
,4251052
,5979193
,4124999
,860563
,4224005
,4417948
,5944477
,5104596
,5827817
,4509679
,6382318
,5993150
,5866799
,6021581
,3708959
,5955794
,3400539
,6047956
,4661515
,3400554
,6411899
,5604276
,4262372
,5101163
,3950850
,4275152
,5904316
,5078663
,5675029
,3053989
,4078723
,2002328
,5873209
,3400566
,3205231
,4555471
,4517436
,5574421
,5032516
,6178694
,6364606
,4567445
,4238680
,5143488
,4328604
,4378108
,5920532
,4910128
,5879614
,4320642
,5048584
,5234140
,4393313
,4411107
,5910202
,6411857
,5719149
,4281500
,5134062
,5616888
,4596768
,6109743
,5769815
,5900862
,3471190
,3690524
,5899704
,4084926
,3400571
,4195788
,4668365
,5794536
,4555478
,5985265
,5995495
,4640640
,6240150
,3995441
,4016376
,5914388
,5637240
,4812429
,5203383
,4189785
,4195921
,4104814
,3400498
,5733786
,3204731
,3827875
,4235759
,4387773
,5002638
,4497152
,5851349
,4426255
,5871879
,4985199
,5948279
,5488882
,5129889
,5264999
,4354063
,5327752
,6067357
,3400529
,4227157
,6364617
,5546334
,6401957
,4608525
,4118712
,4084715
,6044214
,5979318
,4030438
,5980747
,4862368
,5987677
,3769535
,4708202
,4647557
,4197124
,4889147
,4950310
,4444860
,4176150
,6143462
,4812431
,5255724
,3616066
,6025289
,5999140
,229248
,5795914
,6222206
,4596781
,5981198
,4446232
,5611052
,5126811
,4661430
,4195940
,4096886
,5955302
,4731643
,4925000
,3769536
,4086090
,6021580
,6100596
,5938066
,5674994
,4539394
,4148579
,4596080
,6143465
,4630422
,5564426
,5079954
,4189336
,4250242
,5409317
,5653753
,6132169
,6143467
,5300808
,5999689
,4676269
,5100019
,4558331
,5611057
,3847627
,5254752
,3385191
,5761681
,6036192
,5429981
,5109043
,3421278
,4783338
,5948330
,4080540
,6178551
,6100565
,4434606
,4459913
,4264179
,4425666
,4775181
,4404693
,5217766
,5328227
,4927530
,3203821
,4715226
,3400534
,5963442
,4024155
,5029484
,4195840
,3912330
,4307708
,4509676
,4327797
,4586121
,3401488
,5968865
,5181142
,4567458
,3769545
,5957844
,4812417
,5701491
,4301119
,5320556
,3931202
,4319048
,4189520
,4779191
,4263200
,5611055
,6178471
,5557447
,3982922
,5110952
,5417093
,4295745
,4119654
,3203686
,4303147
,3398270
,5979003
,4235614
,4195908
,5078674
,4276414
,5388773
,4977786
,5755569
,4256894
,3690527
,4195926
,4508308
,5301577
,3592740
,5428114
,5754842
,6364629
,4770106
,6102015
,4596778
,5151441
,5503299
,4330190
,3847583
,3950843
,4489166
,4702122
,6364619
,4195782
,4854437
,4673053
,6055511
,4631045
,5213658
,4422455
,5104598
,3847631
,6504134
,4256899
,5563000
,4195895
,5909482
,5979179
,5346752
,5851749
,5979089
,5929832
,5984825
,5104592
,6312865
,6382313
,4426261
,5873217
,6114428
,5688273
,5048085
,4981912
,4426259
,4477374
,4917326
,5043445
,5739287
,5650318
,5592316
,4224011
,4195965
,3351345
,4709374
,4647559
,6364614
,5769811
,6031538
,5078654
,5958097
,5213659
,5972096
,5652577
,4195919
,3897703
,4195973
,5805791
,6152936
,4141314
,5900798
,3982202
,4293380
,4359206
,6381986
,6122571
,3876213
,5900871
,5004565
,4715229
,3209417
,3877284
,5078665
,4115128
,4928324
,4986196
,5358933
,3874722
,3993810
,6009695
,5979372
,5788263
,6061594
,6363076
,6411967
,203148
,3769550
,6143464
,5633171
,4694450
,4458104
,4195814
,5070098
,3253163
,3400578
,6411948
,4862363
,5958337
,3471226
,4763305
,5821259
,3400515
,4003024
,6007017
,3525963
,4195791
,4694474
,3351362
,4195977
,5069762
,4396472
,5818405
,4199483
,5070600
,5811702
,4397595
,3769540
,5857010
,4472549
,4309076
,5744520
,5059364
,5435836
,2833832
,4553745
,4631058
,4276079
,5893652
,4439016
,6044292
,3400572
,3400513
,5979075
,4411112
,5600595
,6100597
,5255723
,4744587
,4836684
,4333570
,4411105
,4439009
,4256886
,4195835
,4016401
,4389731
,5022259
,4014577
,4761312
,5666120
,5845486
,6370191
,5051464
,3400504
,3471202
,5979396
,4136249
,5212578
,3400530
,3901575
,4452075
,5942481
,4078727
,5346981
,5247423
,5932727
,3915891
,5881141
,4647520
,4195951
,4386321
,4055255
,3832467
,5624426
,3400550
,6240156
,4520438
,5078651
,4176121
,4449938
,4596813
,3525379
,4907150
,4805190
,5255725
,5622386
,4689689
,6229571
,5552918
,4522429
,5890097
,6355303
,4955271
,5059356
,6028421
,3997327
,3955992
,3486042
,4256895
,6051135
,4280817
,5860141
,4176161
,5988062
,5744491
,3977497
,4712893
,6420938
,3700595
,4354064
,5870716
,5929257
,5213662
,5979250
,5880409
,5070793
,6381445
,5727274
,4294534
,5744475
,5104655
,6005496
,6504136
,5340656
,5283358
,5681403
,5075663
,5097368
,5299002
,5822379
,5152960
,3585930
,4044895
,5978968
,4056832
,6178462
,2546575
,5744497
,4837025
,4380287
,5227073
,4231654
,4528140
,5846577
,4195944
,5845498
,5505478
,4502697
,6102003
,3823808
,4906490
,6363164
,3511566
,2980524
,5764129
,6305951
,5957847
,4277118
,4624669
,4256889
,5852346
,3400577
,4202831
,5519783
,3769517
,6021979
,5979591
,3400573
,4195817
,3516254
,5574277
,3956088
,5994381
,6401962
,4580005
,4324599
,5804680
,6112949
,4024171
,4068307
,5744517
,6021574
,4090950
,3769552
,5081821
,5790072
,4609437
,5860203
,6060446
,5470792
,6411184
,5300927
,6060453
,5838125
,4066759
,5449822
,5935676
,5530751
,5846590
,3932650
,5494708
,4647537
,5299471
,4241591
,5283141
,6417248
,4411496


)     OR coa.co_id IN (4054556
,6431535
,3299701
,4425663
,6401954
,5958341
,5965788
,5986315
,5255737
,4391381
,4257356
,4195930
,3203641
,4238741
,6143466
,4694480
,6389644
,4016399
,5744481
,5346564
,5277254
,6305997
,5143495
,3205275
,3203838
,4354070
,3707633
,5630878
,4854432
,4540526
,4176119
,4195885
,3673047
,5544488
,5695271
,4054339
,4245955
,5950385
,3360579
,4414831
,3209412
,4391378
,4368385
,4622032
,5351310
,5664102
,4783983
,3400503
,3995439
,3204837
,4210081
,4334186
,5744500
,6148322
,4763646
,4709362
,5154041
,4508846
,5361180
,5078644
,3891805
,5078666
,4272531
,4693438
,4993426
,5980844
,5247427
,5744472
,6237873
,5761677
,4696186
,5564224
,4467671
,5448487
,6411863
,5993169
,4391100
,4195899
,5153434
,4053242
,5463902
,3092484
,6334316
,4812436
,3400537
,5255719
,4111982
,3885459
,4631048
,4354071
,6410097
,4195831
,4426125
,5597509
,5299465
,211649
,4944440
,6000697
,4944443
,6143460
,4508268
,5718077
,4301118
,5417087
,4707984
,5764130
,4733228
,5340660
,4596785
,5538316
,5238702
,5129866
,5814528
,4509674
,5744524
,5916566
,4631077
,4662244
,5012571
,5638420
,5744466
,5774201
,4596789
,2046289
,3391817
,4343735
,5833875
,6384348
,5101168
,4354582
,3988700
,5972131
,5985234
,5491754
,3349786
,4176163
,4136255
,4586115
,5340750
,4592251
,5429986
,5328209
,4195858
,4647525
,2002310
,4838551
,4112930
,4596799
,5242466
,4205235
,3896151
,4264399
,5744444
,3400552
,6363170
,4307119
,5761103
,3515183
,5920512
,4473133
,4281833
,3204591
,4673041
,4432038
,4256878
,5909476
,4046496
,5213649
,3912304
,5673107
,4709364
,4476158
,5915671
,4108570
,5805460
,5069765
,5912828
,5624273
,4681042
,3981757
,4647541
,6364613
,5151434
,3681178
,4119584
,5881158
,4256881
,5413152
,4630412
,4397907
,3769484
,4739711
,5929990
,5611534
,5772553
,4437925
,5760536
,5444611
,5059362
,3400538
,5859304
,1800801
,5912684
,5809198
,4631040
,5838087
,5152712
,4354560
,4426279
,3175385
,4195880
,3205266
,5958327
,4779199
,6334306
))
AND ca.customer_id = coa.customer_id
AND cs.co_id = coa.co_id
--AND SubStr(cs.cs_Stat_chng,-1) IN ('a','s','d')
AND cs.cs_seqno =  (SELECT Max(cs_seqno) FROM contr_services WHERE co_id = cs.co_id )
AND cs.sncode = 1
and cs.dn_id = dn.dn_id
and cs1.sncode = 237
--and SubStr(cs1.cs_Stat_chng,-1) IN ('a','s','d')
and cs.co_id = cs1.co_id
AND cs.cs_Seqno=cs1.cs_seqno
AND cs1.cs_seqno =  (SELECT Max(cs_seqno) FROM contr_services WHERE co_id = cs1.co_id )

--and ch.ch_status IN( 'a','d')
and ch.co_id = coa.co_id
and ch.CH_SEQNO = (select max(CH_SEQNO) from contract_history where co_id = ch.co_id)
union all
--br no. æŸ¥è¯¢1CMNä¸å«PRC number.
SELECT ca.custcode, ca.customer_id, coa.co_id ,dn.dn_num HKG_MSISDN, 'N/A' , ch.ch_status
FROM customer_all ca,  contr_services cs,directory_number dn, contract_all coa,  contract_history ch
WHERE (coa.co_id IN (6178466
,4009545
,5701495
,5794827
,5908427
,5908088
,5881143
,4359012
,4509669
,3972779
,3886598
,6339009
,5789241
,4527717
,4289739
,3769528
,5987659
,6114780
,5817644
,900184
,3236595
,4707126
,3866610
,5102805
,6180130
,4944446
,5905542
,4078681
,4444352
,4007744
,5973678
,5979340
,5864110
,4195890
,5827874
,3855655
,5653751
,2000136
,4287166
,5910268
,6305976
,5391794
,3405924
,3769368
,5957843
,4631070
,5050298
,6168718
,4509678
,5339307
,4078732
,4647544
,6109827
,4136263
,4630413
,5726580
,3400516
,4889086
,4694477
,4354065
,6032054
,4963041
,5657112
,4425165
,5104594
,6010847
,4216755
,4812441
,4523184
,3203683
,2051279
,4708200
,4341235
,6143468
,6382316
,5761822
,5760541
,5255720
,3914226
,3400541
,3400528
,5413294
,4392714
,4404823
,4916842
,4591974
,3400510
,5255731
,4344510
,4992982
,6468807
,5435121
,6016392
,5283483
,6207135
,5616870
,4418546
,4374231
,5878672
,4195881
,4195902
,5952911
,3769557
,6178461
,6178480
,5999144
,5252451
,5814264
,5079961
,4862370
,5048087
,5203376
,4721206
,5958339
,3400501
,3204504
,4104838
,5932483
,5032589
,3998052
,4647524
,5471506
,6109742
,5879850
,5085560
,4481950
,4708198
,5784063
,5786762
,5265562
,4416938
,4256883
,5956096
,5979143
,5524114
,3957960
,4078683
,2046278
,4053711
,4136258
,3205286
,4249685
,5862249
,5248534
,3933702
,43203
,4709368
,5576994
,4024162
,4718829
,5000960
,6411945
,5423978
,5965807
,4930983
,3847598
,6021585
,5979308
,6363361
,6376527
,5620507
,3972773
,4783957
,5567143
,4056819
,5474243
,4437730
,3833779
,5944463
,4930964
,4069376
,4176123
,6200959
,3891790
,4202842
,4179309
,5900864
,6363176
,4062254
,3400568
,6051266
,5326366
,5110765
,5012608
,3205297
,4175188
,5932710
,5255727
,4406348
,5574140
,4812438
,6364627
,4476161
,5057613
,3956080
,6143473
,5849661
,5864424
,4128893
,6203536
,6400348
,6021586
,6371146
,4699310
,4162508
,5695257
,5419832
,6357933
,4425699
,4054564
,6143461
,3400575
,5306944
,5963891
,4303171
,5688257
,5921468
,5042162
,6028857
,6331861
,4326802
,4944455
,4666787
,3574962
,4586116
,5311083
,5817458
,5613945
,3400506
,5859365
,4709371
,5827843
,4887560
,5430134
,5059363
,5913615
,3400517
,5864138
,4057219
,3204475
,5688264
,3863958
,5966146
,4038849
,4595301
,6364622
,5898310
,6001379
,5979934
,4338729
,4596792
,4812426
,4900285
,5255733
,5265524
,4694476
,5615948
,4195825
,4127600
,4811394
,4631072
,5955074
,6268521
,5610284
,6178467
,4694468
,3769544
,6178479
,4622031
,6143469
,4307290
,4123079
,6029320
,3471196
,4848711
,4995284
,3471219
,3923126
,6043523
,4782045
,4195969
,5151439
,5737634
,5932719
,5078649
,5932723
,5682037
,3585863
,344416
,5271964
,6044300
,5078659
,4629810
,4631079
,5176191
,4091076
,5826781
,5827849
,5032523
,4218653
,4707129
,5980358
,4647545
,5684460
,4682179
,6411960
,5417082
,5944839
,4653411
,6411685
,4426250
,3810204
,4411106
,4508305
,5878339
,5078668
,4596808
,6021590
,5194929
,5358048
,3203556
,6382194
,5773059
,5992827
,5272752
,4195915
,6240158
,4245958
,3400542
,5955689
,4596802
,4779185
,4354773
,4708211
,4020508
,5958297
,5110627
,5592304
,6044186
,4389379
,5940746
,6178487
,4090380
,4106374
,4359011
,5653749
,4502566
,5744525
,4195936
,5229284
,6021575
,3894910
,5964396
,3585951
,4956751
,4482600
,5653741
,3690530
,6178478
,4195867
,5881119
,4176124
,3351338
,5247401
,4426265
,5761841
,4154351
,5274739
,3972769
,2002323
,3840476
,4024173
,5048494
,5103917
,3203766
,3916429
,5920523
,4631074
,5957846
,5951885
,5966775
,5203302
,4493710
,4391379
,5712868
,6178583
,6143459
,3400532
,4661410
,193783
,3203503
,4694461
,4664000
,5175136
,4649912
,5739178
,5706024
,5184142
,5305569
,5812711
,4384545
,4410969
,4176156
,5948304
,4504658
,4231331
,4354069
,4489705
,5943117
,4386874
,4596775
,3400556
,6228433
,3174551
,5927683
,5916573
,5105913
,4944457
,3769558
,5340658
,3400514
,6346211
,5247409
,5794604
,5691797
,5059365
,4596766
,5744507
,4595306
,4596770
,4988152
,5255728
,5438593
,3438806
,6178550
,4829331
,5078669
,6380306
,4251052
,5979193
,4124999
,860563
,4224005
,4417948
,5944477
,5104596
,5827817
,4509679
,6382318
,5993150
,5866799
,6021581
,3708959
,5955794
,3400539
,6047956
,4661515
,3400554
,6411899
,5604276
,4262372
,5101163
,3950850
,4275152
,5904316
,5078663
,5675029
,3053989
,4078723
,2002328
,5873209
,3400566
,3205231
,4555471
,4517436
,5574421
,5032516
,6178694
,6364606
,4567445
,4238680
,5143488
,4328604
,4378108
,5920532
,4910128
,5879614
,4320642
,5048584
,5234140
,4393313
,4411107
,5910202
,6411857
,5719149
,4281500
,5134062
,5616888
,4596768
,6109743
,5769815
,5900862
,3471190
,3690524
,5899704
,4084926
,3400571
,4195788
,4668365
,5794536
,4555478
,5985265
,5995495
,4640640
,6240150
,3995441
,4016376
,5914388
,5637240
,4812429
,5203383
,4189785
,4195921
,4104814
,3400498
,5733786
,3204731
,3827875
,4235759
,4387773
,5002638
,4497152
,5851349
,4426255
,5871879
,4985199
,5948279
,5488882
,5129889
,5264999
,4354063
,5327752
,6067357
,3400529
,4227157
,6364617
,5546334
,6401957
,4608525
,4118712
,4084715
,6044214
,5979318
,4030438
,5980747
,4862368
,5987677
,3769535
,4708202
,4647557
,4197124
,4889147
,4950310
,4444860
,4176150
,6143462
,4812431
,5255724
,3616066
,6025289
,5999140
,229248
,5795914
,6222206
,4596781
,5981198
,4446232
,5611052
,5126811
,4661430
,4195940
,4096886
,5955302
,4731643
,4925000
,3769536
,4086090
,6021580
,6100596
,5938066
,5674994
,4539394
,4148579
,4596080
,6143465
,4630422
,5564426
,5079954
,4189336
,4250242
,5409317
,5653753
,6132169
,6143467
,5300808
,5999689
,4676269
,5100019
,4558331
,5611057
,3847627
,5254752
,3385191
,5761681
,6036192
,5429981
,5109043
,3421278
,4783338
,5948330
,4080540
,6178551
,6100565
,4434606
,4459913
,4264179
,4425666
,4775181
,4404693
,5217766
,5328227
,4927530
,3203821
,4715226
,3400534
,5963442
,4024155
,5029484
,4195840
,3912330
,4307708
,4509676
,4327797
,4586121
,3401488
,5968865
,5181142
,4567458
,3769545
,5957844
,4812417
,5701491
,4301119
,5320556
,3931202
,4319048
,4189520
,4779191
,4263200
,5611055
,6178471
,5557447
,3982922
,5110952
,5417093
,4295745
,4119654
,3203686
,4303147
,3398270
,5979003
,4235614
,4195908
,5078674
,4276414
,5388773
,4977786
,5755569
,4256894
,3690527
,4195926
,4508308
,5301577
,3592740
,5428114
,5754842
,6364629
,4770106
,6102015
,4596778
,5151441
,5503299
,4330190
,3847583
,3950843
,4489166
,4702122
,6364619
,4195782
,4854437
,4673053
,6055511
,4631045
,5213658
,4422455
,5104598
,3847631
,6504134
,4256899
,5563000
,4195895
,5909482
,5979179
,5346752
,5851749
,5979089
,5929832
,5984825
,5104592
,6312865
,6382313
,4426261
,5873217
,6114428
,5688273
,5048085
,4981912
,4426259
,4477374
,4917326
,5043445
,5739287
,5650318
,5592316
,4224011
,4195965
,3351345
,4709374
,4647559
,6364614
,5769811
,6031538
,5078654
,5958097
,5213659
,5972096
,5652577
,4195919
,3897703
,4195973
,5805791
,6152936
,4141314
,5900798
,3982202
,4293380
,4359206
,6381986
,6122571
,3876213
,5900871
,5004565
,4715229
,3209417
,3877284
,5078665
,4115128
,4928324
,4986196
,5358933
,3874722
,3993810
,6009695
,5979372
,5788263
,6061594
,6363076
,6411967
,203148
,3769550
,6143464
,5633171
,4694450
,4458104
,4195814
,5070098
,3253163
,3400578
,6411948
,4862363
,5958337
,3471226
,4763305
,5821259
,3400515
,4003024
,6007017
,3525963
,4195791
,4694474
,3351362
,4195977
,5069762
,4396472
,5818405
,4199483
,5070600
,5811702
,4397595
,3769540
,5857010
,4472549
,4309076
,5744520
,5059364
,5435836
,2833832
,4553745
,4631058
,4276079
,5893652
,4439016
,6044292
,3400572
,3400513
,5979075
,4411112
,5600595
,6100597
,5255723
,4744587
,4836684
,4333570
,4411105
,4439009
,4256886
,4195835
,4016401
,4389731
,5022259
,4014577
,4761312
,5666120
,5845486
,6370191
,5051464
,3400504
,3471202
,5979396
,4136249
,5212578
,3400530
,3901575
,4452075
,5942481
,4078727
,5346981
,5247423
,5932727
,3915891
,5881141
,4647520
,4195951
,4386321
,4055255
,3832467
,5624426
,3400550
,6240156
,4520438
,5078651
,4176121
,4449938
,4596813
,3525379
,4907150
,4805190
,5255725
,5622386
,4689689
,6229571
,5552918
,4522429
,5890097
,6355303
,4955271
,5059356
,6028421
,3997327
,3955992
,3486042
,4256895
,6051135
,4280817
,5860141
,4176161
,5988062
,5744491
,3977497
,4712893
,6420938
,3700595
,4354064
,5870716
,5929257
,5213662
,5979250
,5880409
,5070793
,6381445
,5727274
,4294534
,5744475
,5104655
,6005496
,6504136
,5340656
,5283358
,5681403
,5075663
,5097368
,5299002
,5822379
,5152960
,3585930
,4044895
,5978968
,4056832
,6178462
,2546575
,5744497
,4837025
,4380287
,5227073
,4231654
,4528140
,5846577
,4195944
,5845498
,5505478
,4502697
,6102003
,3823808
,4906490
,6363164
,3511566
,2980524
,5764129
,6305951
,5957847
,4277118
,4624669
,4256889
,5852346
,3400577
,4202831
,5519783
,3769517
,6021979
,5979591
,3400573
,4195817
,3516254
,5574277
,3956088
,5994381
,6401962
,4580005
,4324599
,5804680
,6112949
,4024171
,4068307
,5744517
,6021574
,4090950
,3769552
,5081821
,5790072
,4609437
,5860203
,6060446
,5470792
,6411184
,5300927
,6060453
,5838125
,4066759
,5449822
,5935676
,5530751
,5846590
,3932650
,5494708
,4647537
,5299471
,4241591
,5283141
,6417248
,4411496


)     OR coa.co_id IN (4054556
,6431535
,3299701
,4425663
,6401954
,5958341
,5965788
,5986315
,5255737
,4391381
,4257356
,4195930
,3203641
,4238741
,6143466
,4694480
,6389644
,4016399
,5744481
,5346564
,5277254
,6305997
,5143495
,3205275
,3203838
,4354070
,3707633
,5630878
,4854432
,4540526
,4176119
,4195885
,3673047
,5544488
,5695271
,4054339
,4245955
,5950385
,3360579
,4414831
,3209412
,4391378
,4368385
,4622032
,5351310
,5664102
,4783983
,3400503
,3995439
,3204837
,4210081
,4334186
,5744500
,6148322
,4763646
,4709362
,5154041
,4508846
,5361180
,5078644
,3891805
,5078666
,4272531
,4693438
,4993426
,5980844
,5247427
,5744472
,6237873
,5761677
,4696186
,5564224
,4467671
,5448487
,6411863
,5993169
,4391100
,4195899
,5153434
,4053242
,5463902
,3092484
,6334316
,4812436
,3400537
,5255719
,4111982
,3885459
,4631048
,4354071
,6410097
,4195831
,4426125
,5597509
,5299465
,211649
,4944440
,6000697
,4944443
,6143460
,4508268
,5718077
,4301118
,5417087
,4707984
,5764130
,4733228
,5340660
,4596785
,5538316
,5238702
,5129866
,5814528
,4509674
,5744524
,5916566
,4631077
,4662244
,5012571
,5638420
,5744466
,5774201
,4596789
,2046289
,3391817
,4343735
,5833875
,6384348
,5101168
,4354582
,3988700
,5972131
,5985234
,5491754
,3349786
,4176163
,4136255
,4586115
,5340750
,4592251
,5429986
,5328209
,4195858
,4647525
,2002310
,4838551
,4112930
,4596799
,5242466
,4205235
,3896151
,4264399
,5744444
,3400552
,6363170
,4307119
,5761103
,3515183
,5920512
,4473133
,4281833
,3204591
,4673041
,4432038
,4256878
,5909476
,4046496
,5213649
,3912304
,5673107
,4709364
,4476158
,5915671
,4108570
,5805460
,5069765
,5912828
,5624273
,4681042
,3981757
,4647541
,6364613
,5151434
,3681178
,4119584
,5881158
,4256881
,5413152
,4630412
,4397907
,3769484
,4739711
,5929990
,5611534
,5772553
,4437925
,5760536
,5444611
,5059362
,3400538
,5859304
,1800801
,5912684
,5809198
,4631040
,5838087
,5152712
,4354560
,4426279
,3175385
,4195880
,3205266
,5958327
,4779199
,6334306
))

AND ca.customer_id = coa.customer_id
AND cs.co_id = coa.co_id
--AND SubStr(cs.cs_Stat_chng,-1) IN ('a','s','d')
AND cs.cs_seqno =  (SELECT Max(cs_seqno) FROM contr_services WHERE co_id = cs.co_id     )
AND cs.sncode = 1
and cs.dn_id = dn.dn_id
and not exists( select 1 from contr_services cs2 where cs2.sncode = 237 and cs2.co_id = cs.co_id
AND cs2.cs_seqno =  (SELECT Max(cs_seqno) FROM contr_services WHERE co_id = cs.co_id ))
--and ch.ch_status IN('a','d')
and ch.co_id = coa.co_id
and ch.CH_SEQNO = (select max(CH_SEQNO) from contract_history where co_id = ch.co_id)
order by custcode,customer_id
;

